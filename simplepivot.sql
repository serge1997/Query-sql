SELECT 'GERENTE' AS GERENTE, DEVOLUCAO, COD_PRODUTO,
	[900000-GERENTE CURITIBA _Adilson],
	[900003-GERENTE SP _Eduardo],
	[900006-GERENTE TELEVENDAS_Patricia],
	[900002-GERENTE SC  _Eliezer],
	[900004-GERENTE RUBBERMAID _ Aramis],
	[900008-GERENTE SP_CAPITAL_Andre],
	[900003-GERENTE SP _INTERIOR_ADILSON],
	[900001-GERENTE INT PR  _Marcio],
	[900008-DIVISAO SP_CAPITAL_Andre]

FROM (
	SELECT
		NOME_GERENTEUA1,
		VENDA,
		DEVOLUCAO,
		COD_PRODUTO
	FROM VENDAS
	WHERE EMISSAO = '20230830'
	AND DUPLIC = 'S'
)AS SRCTABLE
PIVOT(
	SUM(VENDA)
	FOR NOME_GERENTEUA1 IN([900000-GERENTE CURITIBA _Adilson],
	[900003-GERENTE SP _Eduardo],
	[900006-GERENTE TELEVENDAS_Patricia],
	[900002-GERENTE SC  _Eliezer],
	[900004-GERENTE RUBBERMAID _ Aramis],
	[900008-GERENTE SP_CAPITAL_Andre],
	[900003-GERENTE SP _INTERIOR_ADILSON],
	[900001-GERENTE INT PR  _Marcio],
	[900008-DIVISAO SP_CAPITAL_Andre])
)AS PIVOTTABLE



WITH CTE AS
	(
		SELECT 
			YEAR(EMISSAO) ANO,
			COD_VEND,
			ROUND(SUM(VENDA), 2) VENDA
		FROM VENDAS
		WHERE DUPLIC = 'S'
		AND COD_VEND IN ('003', '014', '023', '065', '075', '056', '029', '089')
		GROUP BY YEAR(EMISSAO), COD_VEND
		--ORDER BY YEAR(EMISSAO) DESC
	)SELECT 
		'ANO' AS ANO, COD_VEND,
		[2023], [2022], [2021], [2020], [2019], [2018],
		[2017], [2016], [2015], [2014], [2013], [2012]
	FROM (
		SELECT
			ANO,
			COD_VEND,
			VENDA
		FROM CTE
	)AS SRCTABLE
PIVOT(
	SUM(VENDA) FOR
	ANO IN ([2023], [2022], [2021], [2020], [2019], [2018],
	[2017], [2016], [2015], [2014], [2013], [2012])
)PVTABLE




--SELECT DISTINCT NOME_GERENTEUA1 FROM VENDAS
